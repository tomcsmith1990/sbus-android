% The master copy of this demo dissertation is held on my filespace
% on the cl file serve (/homes/mr/teaching/demodissert/)

% Last updated by MR on 2 August 2001

\documentclass[12pt,twoside,notitlepage]{report}

\usepackage{a4}
\usepackage{verbatim}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{listings}

\input{epsf}                            % to allow postscript inclusions
% On thor and CUS read top of file:
%     /opt/TeX/lib/texmf/tex/dvips/epsf.sty
% On CL machines read:
%     /usr/lib/tex/macros/dvips/epsf.tex



\raggedbottom                           % try to avoid widows and orphans
\sloppy
\clubpenalty1000%
\widowpenalty1000%

\addtolength{\oddsidemargin}{6mm}       % adjust margins
\addtolength{\evensidemargin}{-8mm}

\renewcommand{\baselinestretch}{1.1}    % adjust line spacing to make
                                        % more readable

\begin{document}

\bibliographystyle{plain}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Title


\pagestyle{empty}

\hfill{\LARGE \bf Thomas Smith}

\vspace*{60mm}
\begin{center}
\Huge
{\bf Automatic Configuration in Mobile Environments} \\
\vspace*{5mm}
Computer Science Tripos Part II \\
\vspace*{5mm}
Sidney Sussex College \\
\vspace*{5mm}
\today  % today's date
\end{center}

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Proforma, table of contents and list of figures

\setcounter{page}{1}
\pagenumbering{roman}
\pagestyle{plain}

\chapter*{Proforma}

{\large
\begin{tabular}{ll}
Name:               & \bf Thomas Smith	\\
College:            & \bf Sidney Sussex College	\\
Project Title:      & \bf Automatic Configuration \\ &\bf in Mobile Environments	\\
Examination:        & \bf Computer Science Tripos Part II, 2013 	\\
Word Count:         & \bf 1772\footnotemark[1] \\
Project Originator: & Dr Jatinder Singh		\\
Supervisor:         & Dr Jatinder Singh		\\ 
\end{tabular}
}

\footnotetext[1]{This word count was computed by {\tt detex diss.tex | tr -cd '0-9A-Za-z $\tt\backslash$n' | wc -w}}
\stepcounter{footnote}


\section*{Original Aims of the Project}

The original aim of the project was to create a system which could adapt to the changes in context which come with mobility, such as location or networks. 
This required the ability to detect these changes, in order to find and connect to new data sources. 
As a new data source may have different data schema to the expected schema, the system must offer a way to make meaningful use of this data in relation to the expected schema.

\section*{Work Completed}

A messaging middleware was modified to allow users to search for data sources by aspects of their schema. Users can search for an exact match on some part of a schema, or a looser match which only considers field types, and not names.
This middleware was ported for use on Android. An application was created which could monitor changes in context and then inform other applications of this change, or automatically connect them to new data sources, dependent on their preferences.

\section*{Special Difficulties}

The main difficulty in the project came from porting the messaging middleware to Android. The Android NDK\footnote{http://developer.android.com/tools/sdk/ndk/index.html} toolkit was used in order to compile C++ for use on Android, however missing libraries and poor documentation made this task more difficult than expected.
 
\newpage
\section*{Declaration}

I Thomas Smith of Sidney Sussex College, being a candidate for Part II of the Computer
Science Tripos, hereby declare that this dissertation and the work described in it are my own work,
unaided except as may be specified below, and that the dissertation
does not contain material that has already been used to any substantial
extent for a comparable purpose.

\bigskip
\leftline{Signed: }

\bigskip
\leftline{Date: }

\cleardoublepage

\tableofcontents

\listoffigures

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% now for the chapters

\cleardoublepage        % just to make sure before the page numbering
                        % is changed

\setcounter{page}{1}
\pagenumbering{arabic}
\pagestyle{headings}

% Intro + Preparation ~ 1400 words
\chapter{Introduction}

% summarise
While many applications now exist for mobile devices, few applications themselves are truly mobile. 
The user may happen to be mobile, however the application does not adapt to different environments. 
This project addresses the issues faced in creating applications which can change to suit different environments. 
I show how an application can find relevant data sources in an environment, and how it may offer flexibility in the data it uses.

\section{Problem}
% what's the problem
Different environments mean that devices operate in different contexts and scopes, which dictate how a device can interact with the environment. 
Context may consist of both physical attributes, such as available Wi-Fi networks and location, and user behaviour. 
For example, the device may deduce from the accelerometer that the user is running, in which case the user may be in a rush and require different data.
Scope is also an important factor, since data sources may only be available on a particular network, or within a given time period. 
Changes in context and scope mean that an application may no longer be able to communicate with a given data source, or the data it is providing may no longer be useful. 
In this situation, an alternative data source must be found.

Once this alternate data source has been found, the application must still determine whether it provides useful data. 
Some data may be absolutely necessary for operation of the application, while other parts may be desired, but operation can continue without them. 
However, even if a data source is deemed useful, the application may still have the difficulty of the data being presented in an alternate format to the expected format. 
Some fields may be missing, there may be additional fields, and some fields may have different names. 

% example
For example, a transport application may face differences in data available about Virgin Trains (Figure \ref{fig:virgintrain}) and London Midland trains (Figure \ref{fig:londonmidlandtrain}). 
Both will offer the same data to a large extent, such as stations, arrival times, and platform numbers, however Virgin Trains might also include a menu for an on-board shop. 
Alternatively, the application may be used in a French railway station. 
Data about the trains will still be very similar, however the field names may be in French (Figure \ref{fig:frenchtrain}). 
While these differences may be important when the user is sat waiting for a train, they become less important when the user is running to catch a train, and simply needs the departure time and platform number.
Given the amount of uncertainty about what data will be available, a developer creating this application cannot hope to account for all possibilities. The developer can however specify how the application should behave in different contexts.

\section{Project}

% what I've done
Schilit et al \cite{Schilit:1994:CCA:1439278.1440041}  define a context-aware system as one which can examine the computing environment and react to changes in the environment. 
This project creates such a system, which performs automatic contextual reconfiguration for applications whenever there is a change in the environment. 
Pascoe \cite{Pascoe:1998:AGC:857199.858020} defines four context-aware capabilites, two of which occur in this reconfiguration. 
Contextual resource discovery is used to discover data sources available within the context, and contextual adaptation allows the application to adapt to these data sources' schemas in order to use the sources.

Applications on the device can register with the system, which then handles any reconfiguration necessary.
When registering, an application can specify whether the system should automatically reconfigure it's connection, or whether it should simply notify the application of a change in context, allowing the application to perform a callback method.
As part of this registration, constraints may be specified about how the application wants the connection to be reconfigured. 
These may be simple constraints, such as the name of a data source, or more complex constraints regarding the structure of the data which the source uses. 
Once the system detects a change in the environment, it notifies applications of the change or connects them to different sources, as specified in their registrations.

Depending on the constraints, an application may be connected to a data source which does not offer the expected data schema. 
The system handles this by repackaging messages to match the application's schema. Any extraneous fields are removed, while any absent fields are filled with ``empty'' values. The constraints are used to infer relationships between fields, even if they have different names. 
Once the system has repackaged the message, it passes it to the application, allowing the application to continue as if it had received a message conforming to its schema.

\cleardoublepage

 
\chapter{Preparation}


\cleardoublepage


% ~ 4000 words
\chapter{Implementation}


\cleardoublepage


% ~ Eval + Conclusion ~ 2000 words
\chapter{Evaluation}


\cleardoublepage

\chapter{Conclusion}

% summarise
The project has created a context-aware system which enables developers to write applications without knowing in advance where data will be available, or what format the data will be in.
An application will only ever be presented with data conforming to its own schema, removing uncertainty about the format of the data. 
Applications may specify constraints about how fields in a data source's schema must match its own, as either an exact match, a type-match, or don't care about a match.
This gives the application control over which data sources it can be connected to, but does not require the application to find the data sources itself. 
Upon a change in context, the system will reconfigure connections ensuring that they conform to these constraints, allowing applications to continue receiving fresh data.

Referring back to the train example from the Introduction, there may be an application using the London Midland train schema (Figure \ref{fig:londonmidlandtrain}) which requires data sources to have at least a structure matching the type of the {\tt train} structure. 
At a small train station which only London Midland trains serve, all data sources will match this schema exactly, so the application can connect to any of them.
Upon arriving at a larger train station and connecting to a Wi-Fi network, the system detects a change in context, and consequently connects the application to a new data source. 
The user may be changing to a Virgin train here, however information about these trains uses a different schema (Figure \ref{fig:virgintrain}). 
This schema does not match the application schema exactly, however it does contain the necessary {\tt train} structure. 
Therefore, the system connects the application to this data source, and repackages messages to match the application schema, allowing the same application code to handle the message.

%something about subscriptions

\section{Issues}

\begin{itemize}
\item Rapidly changing context - connecting then disconnecting from Wi-Fi messes stuff up.
\end{itemize}

\section{Changes}

\section{Further Work}

Currently the system only uses a change in network status to detect a change in context. 
The Android platform offers a whole host of different events\footnote{http://developer.android.com/reference/android/content/Intent.html} and sensors\footnote{http://developer.android.com/guide/topics/sensors/sensors\_overview.html} which can be used to determine a change in context, such as the battery level being low, the timezone changing, or accelerometer readings. 
The system could be extended to use more of these features to determine a change in context, allowing applications to specify how they want to react to different types of change in context.

Furthermore, the constraints on the schema of the data sources which the application can be connected to are specified in terms of the field names of the application schema. 
While this works provided there are no repeated fields names within a schema, it would fail on a schema such as Figure \ref{fig:repeatednameschema}. 
A solution to this would be to qualify all names specified in the constraints in a similar way to subscriptions. 
We could specify a constraint for {\tt sensor}, meaning the entire structure, or {\tt sensor/sensor}, meaning the text field.

\begin{figure}[h]
\begin{lstlisting}
@sensor
{
	txt sensor
	int value
}
\end{lstlisting}
\caption[Schema with repeated name]{A schema with a structure named {\tt sensor} and a text field also named {\tt sensor}. A constraint specified on {\tt sensor} would be ambiguous without fully qualified names.}
\label{fig:repeatednameschema}
\end{figure}

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% the bibliography

\addcontentsline{toc}{chapter}{Bibliography}
% nocite means add all references even if not cited - TODO: remove in final version
\nocite{*}
\bibliography{refs}
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% the appendices
\appendix

\chapter{Possible Titles}

\begin{itemize}
\item Automatic Communication Configuration in Mobile Environments
\item Data Stream Connection and Message Negotiation
\item Flexibile Data Streams in Mobile Environments
\item Automatic Data Stream Configuration in Mobile Environments
\end{itemize}

\cleardoublepage

\chapter{Example Schemas}

\input{schemas}

\cleardoublepage

% should this be an appendix?
\chapter{Project Proposal}

\input{propbody}

\end{document}
